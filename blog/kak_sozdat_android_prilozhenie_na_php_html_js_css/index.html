<!DOCTYPE html>
<html xml:lang="ru" lang="ru">
	<head>
		<meta charset="WINDOWS-1251">
		<meta name="viewport" content="	initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,target-densitydpi=device-dpi,	width=device-width,height=device-height,shrink-to-fit=no">
		<title>Сайт Андрея</title>
		<link rel="stylesheet" type="text/css" href="/s/bootstrap4.2.1.min.css">
		<link rel="stylesheet" type="text/css" href="/s/app.css">
		<link rel="stylesheet" type="text/css" href="/j/prism/0.css">
		<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" >
	</head>
	<body>
		<div class="container u-full-width">
			<header>
				<div class="row">
					<div class="col">
						<div class="text-left u-mainhead">
							<h1>Блог Андрея</h1>
						</div>
					</div>
				</div>
			</header>
			<div>&nbsp;</div>
			<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
			  <a class="navbar-brand" href="/">Начало</a>
			  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			  </button>

			  <div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto">
				  <li class="nav-item">
					<a class="nav-link" href="/portfolio">Портфолио</a>
				  </li>
				  <li class="nav-item active">
					<a class="nav-link" href="javascript:;">Блог</a>
				  </li>
				  <li class="nav-item">
					<a class="nav-link" href="/clients">Клиентам</a>
				  </li>
				</ul>
			  </div>
			</nav>
			<div>&nbsp;</div>
			<div class="row">
				<div class="col-12 col-lg-8">
					<article>
						<h1> Как создать android приложение на php (+ html + js + css)</h1>
						<p>Статья адресована людям, занимающимся разработкой на PHP, у которых возникла необходимость по быстрому сделать android-приложение для личного пользования.</p>
						<p>Прежде всего хочется обратиться к профессиональным разработчикам android-приложений и к людям не занимающимся вообще никакой разработкой.</p>
						<p>Это <strong>НЕ</strong> статья о том как профессионально разрабатывать android приложения. Если вы не профессионал и ничего не знаете о профессиональной разработке android приложений, но хотите им стать, <strong>вам не надо это читать</strong>.</p>
						<p>Если вы профессиональный разработчик android приложений, вы не найдёте здесь ничего интересного.</p>
						<p>Приложение может стать вполне рабочим, например <a href="https://play.google.com/store/apps/details?id=land.learn.hw19" target="_blank">вот это в Google Play</a> опубликовано без проблем. (Скачиваний маловато, но я не задавался целью раскрутить приложение, я создал его для своих нужд, а ссылка на маркете позволяет легко им делиться с друзьями).</p>
						<p>Наверное, невозможно найти разработчика на PHP, который категорически не смог бы сверстать в HTML требуемый ему интерфейс, оживить его с помощью javascript и придать нужный ему вид с помощью css. </p>
						<p>Не все из нас смогут сделать то же самое работая на заказ, требования к фронтенду современных продакшен сайтов могут оказаться трудновыполнимыми, а порой и вообще непонятными.</p>
						<p>С другой стороны, когда нам нужен какой-то web-интерфейс для личного пользования, мы с лёгкостью его реализуем используя весь этот html/js/css так, как будто мы всю жизнь только фронтендом и занимались.</p>
						<p>Думаю, ни для кого не секрет, что можно сделать android приложение c webView и поместить в него ваш HTML5 интерфейс, но как взаимодействовать с устройством?</p>
						<p>Взаимодействие с устройством осуществляется добавлением программного интерфейса в виде объекта javascript. Вызывая методы этого объекта программист может из webView взаимодействовать например с файловой системой устройства, делать в принципе всё, что позволяют методы этого объекта, реализованные на языке Java.</p>
						<p>Мне, как человеку много лет кодившим на php  и иногда на javascript показалось очень удобным иметь в своём js коде объект с именем PHP и обеспечивающим как можно большее количество php функций, вызывая которые я мог бы например работать с файлами устройства, оперировать функцией date и другими. </p>
						<p>Конечно, реализовать все PHP функции маловероятно, но мне это и не надо, буду добавлять по мере необходимости.</p>
						<p>Сейчас реализованы вот такие функции <a href="https://github.com/lamzin-andrey/phpforjava/blob/master/PHPInterface.java" target="_blank">ссылка на исходный код PHPInterface</a></p>
						<p><a href="https://github.com/lamzin-andrey/phpforjava" target="_blank">Репозиторий на гитхаб</a> в котором этот класс будет время от времени обновляться и совершенствоваться.</p>
						<p>Как подтверждение, что это вполне жизнеспособная библиотека вот <a href="https://github.com/lamzin-andrey/CleverBrightness" target="_blank">исходный код android приложения опубликованного на маркете</a>.</p>
						<p>Ниже описаны особенности реализованых методов (если метод работает полностью совместимо с стандартной функцийе php его нет в этой таблице).</p>
											
						<table class="table table-bordered table-striped">
							<thead>
								<tr>
									<th>Метод</th>
									<th>Особенности</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><code>file_get_contents</code></td>
									<td>На данным момент принимает только короткие имена файлов (например <code>"file.txt"</code>). Созданный файл будет доступен только тому приложению, которое его создало. 
									Планируется в дальнейшем поддержка полных имён файлов, например <code>"/mnt/sdcard/app/data/file.txt"</code>.
									</td>
								</tr>
								<tr>
									<td><code>file_exists</code></td>
									<td>См. <code>file_get_contents</code></td>
								</tr>
								<tr>
									<td><code>file_put_contents</code></td>
									<td>См. <code>file_get_contents</code>. Также, надо иметь ввиду, что при использовании констант, например <code>FILE_APPEND</code>, нужно использовать <code>PHPInterface.FILE_APPEND</code>;
									</td>
								</tr>
								<tr>
									<td><code>str_replace( String search, String replace, String subject, boolean getCount)</code></td>
									<td>В отличии от оргигнальной php функции, если нам нужно количество замен, мы не передаём переменную по ссылке, а указываем вместо неё true. Тогда <code>PHPInterface.STR_REPLACE_COUNT</code> будет содержать количество замен после вызова метода.</td>
								</tr>
								<tr>
									<td><code>in_array(needle, haystack)</code></td>
									<td>Пока работает только с массивами строк и целых чисел (<code>long</code> и <code>int</code>)</td>
								</tr>
								<tr>
									<td><code>strval</code></td>
									<td>Пока работает только с аргументами типа <code>long</code> и <code>int</code></td>
								</tr>
								<tr>
									<td><code>count</code></td>
									<td>Не работает с простыми типами java (такими как <code>long</code> и <code>int</code>), только с теми, которые наследуются от <code>Object</code></td>
								</tr>
							</tbody>
						</table>
						<p>Список методов, реализванных на <date>2019-05-30</date></p>
						<ul class="list-group">
							<li class="list-group-item active">Методы PHPInterface</li>
							<li class="list-group-item">count</li>
							<li class="list-group-item">date</li>
							<li class="list-group-item">file_get_contents</li>
							<li class="list-group-item">file_exists</li>
							<li class="list-group-item">file_put_contents</li>
							<li class="list-group-item">in_array</li>
							<li class="list-group-item">intval</li>
							<li class="list-group-item">str_replace</li>
							<li class="list-group-item">strlen</li>
							<li class="list-group-item">strval</li>
							<li class="list-group-item">time</li>
						</ul>
						
						<p>Примеры использования в java коде:</p>
						<pre class="border pl-2"><code class="language-java">
public class MainActivity extends Activity{
	
	public PHPInterface PHP;
	
	public void foo() {
		PHP = new PHPInterface(this.getApplicationContext());
		long currentTimestamp = PHP.time();
	}
}
						</code></pre>
<p>или, если нужен при работе приложения в фоне:</p>
<pre class="border pl-2"><code class="language-java">
public class ServiceDM extends Service{
	
	public PHPInterface PHP;
	
	public void foo() {
		PHP = new PHPInterface(this);
		long currentTimestamp = PHP.time();
	}
}
						</code></pre>
<p>Пример использования в javascript коде:</p>
<pre class="border pl-2"><code class="language-javascript">
//Практически в любом месте js загруженного в webView
var currentTimestamp = PHP.time();
PHP.file_put_contents('time_of_start.txt', currentTimestamp);
						</code></pre>
					</article>
				</div>
				<div class="col-12 col-lg-4  u-right-side">
					<ul class="list-group text-center">
						<li class="list-group-item">
							<div><img src="/i/fx.jpg" alt="Fastxampp"></div>
							<div> <!-- style="border-top-width: 0px;" -->
								<a href="//fastxampp.org" target="_blank">Утилита для удобного добавления сайтов на localhost</a>
							</div>
						</li> 
						<li class="list-group-item">
							<div><img src="/i/L.jpg"  alt="cordova online"></div>
							<div><a target="_blank" href="http://fastxampp.org/compile_android_online_apache_cordova/">Компиляция html5 приложений cordova для android онлайн</a><br>
								<p>
									<small>
									</small>
								</p>
							</div>
						</li>
						<li class="list-group-item">
							<div>
								<img src="/i/php2js.jpg" title="" alt="">
							</div>
							<div>
								<a href="http://php2js.ru/" target="_blank">Транслятор php кода в код javascript</a><br>
							</div>
						</li>
						<li class="list-group-item">
							<div><img src="/i/rc.jpg" alt="RedCafe"></div>
							<div><a href="http://redcafe.ru/">Программа для создания выкроек стильной одежды</a></div>
							<p>
								<small>Мой вклад - оффлайн-версия программы для экспорта выкроек в pdf и dxf</small></div>
							</p>
						</li>
					</ul>
				</div>
			</div>
		</div>
		
			<div class="footer bg-dark text-light">
				
					<div class="container">
						<div class="row">
							<div class="col">
								&copy; Андрей Ламзин
							</div>
						</div>
					</div>
				
			</div>
		
        <script src="/j/jquery-3.3.1.slim.min.js"></script>
        <script src="/j/bootstrap4.2.1.min.js"></script>
        <script src="/j/popper1.14.6.min.js"></script>
        <script src="/j/prism/0.js"></script>
        <script src="/j/app.js"></script> 
        <link rel="stylesheet" type="text/css" href="/s/bootstrap4_sticky_footer.css">
	</body>
</html>
