<!DOCTYPE html>
<html xml:lang="ru" lang="ru">
	<head>
		<meta charset="WINDOWS-1251">
		<meta name="viewport" content="	initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,target-densitydpi=device-dpi,	width=device-width,height=device-height,shrink-to-fit=no">
		<title>Использование наследования и классов в javascript с laravel-mix - Сайт Андрея</title>
		<link rel="stylesheet" type="text/css" href="/s/bootstrap4.2.1.min.css">
		<link rel="stylesheet" href="/s/fontawesome5/all.css" >
		<link rel="stylesheet" type="text/css" href="/s/app.css">
		<link rel="stylesheet" type="text/css" href="/j/prism/0.css">
		<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" >
		<link rel="canonical" href="https://www.andryuxa.ru/blog/ispolzovanie_nasledovaniya_i_klassov_v_javascript_s_laravel_mix/">
	</head>
	<body>
		<div class="container u-full-width">
			<header>
				<div class="row">
					<div class="col">
						<div class="text-left u-mainhead">
							<h1>Блог Андрея</h1>
						</div>
					</div>
				</div>
			</header>
			<div>&nbsp;</div>
			<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
			  <a class="navbar-brand" href="/">Начало</a>
			  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			  </button>

			  <div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto">
				  <li class="nav-item">
					<a class="nav-link" href="/portfolio">Портфолио</a>
				  </li>
				  <li class="nav-item active">
					<a class="nav-link" href="javascript:;">Блог</a>
				  </li>
				  <li class="nav-item">
					<a class="nav-link" href="/clients">Клиентам</a>
				  </li>
				</ul>
			  </div>
			</nav>
			<div>&nbsp;</div>
			<div class="row">
				<div class="col-12 col-lg-8">
					<article>
<h1>Использование laravel-mix для сборки кода использующего наследование в javascript</h1>
<time datetime="2019-06-20" class="d-block text-right text-muted small">20.06.2019</time>
<p>После запуска laravel-mix могут появляться ошибки вида &laquo;ReferenceError: A is not defined&raquo; имеющие смысл &laquo;класс A не найден&raquo;.</p>
<p>Если вы новичок в использовании laravel-mix для сборки вашего js кода в один минимизированый файл, 
но вместе с тем привыкли использовать наследование,
вы можете стокнуться со следующей проблемой: если вы подключаете скрипты с определениями классов и
&laquo;главный&raquo; скрипт приложения непосредственно на страницу всё работает, но при подключении результата работы 
laravel-mix или webpack вы видите в консоли ошибку &laquo;A is undefined&raquo;
где A - имя одного из определённых вами в приложении классов.
</p>

<p>Забегая вперёд, скажу, что проблема решается двумя строчками:</p>
<ol>
	<li>
		После определения каждого класса добавляем строку кода:
		<pre><code class="language-javascript">
export default YourClassName;
		</pre></code>
	</li>
	<li>
		В начале каждого класса - наследника (или скрипта использующего несколько классов)
		 добавляем одну или несколько строк вида:
		 
		<pre><code class="language-javascript">
import  YourClassName from './your_class_name';
		</pre></code> (Здесь your_class_name - часть имени файла your_class_name.js)
	</li>
</ol>

<p>Далее приведу полный пример, полезный для динозавров и людей, которые всё ещё с трудом 
работают с инструментами nodejs. включая package.json и webpack.js.</p>


<p>Итак, пусть есть такой &laquo;традиционный&raquo; javascript в четырёх файлах.</p>
<p>Файл class_a.js</p>
<pre><code class="language-javascript">
class A {
	constructor() {
		this.init();
	}
	init() {
		console.log('I class A');
	}
}
</pre></code>

<p>Файл class_b.js</p>
<pre><code class="language-javascript">
class B extends A {
	init() {
		console.log('I class B');
	}
}
</pre></code>

<p>Файл app.js</p>
<pre><code class="language-javascript">
window.addEventListener('load', function() {
	new B(); 
});

</pre></code>

<p>Если подключить их на страницу таким вот образом:</p>
<pre><code class="language-html">
&lt;!DOCTYPE html&gt;
&lt;html xml:lang="ru" lang="ru"&gt;
	&lt;head&gt;
		&lt;meta charset="UTF-8"&gt;
		&lt;title&gt;Empty web page&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
        &lt;script src="/js/jquery-3.3.1.slim.min.js"&gt;&lt;/script&gt;
        &lt;script src="/js/class_a.js"&gt;&lt;/script&gt;
        &lt;script src="/js/class_b.js"&gt;&lt;/script&gt;
        &lt;script src="/js/app.js"&gt;&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></code>
<p>Мы увидим в консоли сообщение &laquo;I class B&raquo;, как и должно быть.</p>

<p>Далее мы будем подключать вместо трёх файлов один, который нам создаст laravel-mix.
Для этого создадим файл package.json такого содержания:</p>
<pre><code class="language-json">
{
	"private": true,
	"scripts": {
		"dev": "npm run development",
		"development": "cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",
		"watch": "npm run development -- --watch",
		"watch-poll": "npm run watch -- --watch-poll",
		"prod": "npm run production",
		"production": "cross-env NODE_ENV=production node_modules/webpack/bin/webpack.js --no-progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",
		"test": "echo 'Error: no test specified' && exit 1"
	},
	"devDependencies": {
		"cross-env": "^5.2.0",
		"jquery": "^1.9.1",
		"laravel-mix": "^2.1.11"
	}
}
</pre></code>
<p>Выполним</p>
<pre><code class="language-bash">npm install</pre></code>
<p>И создадим рядом с package.json файл webpack.mix.js</p>
<pre><code class="language-javascript">let mix = require("laravel-mix");
mix.js('app.js',"pack.js");
</pre></code>

Выполним
<pre><code class="language-bash">npm run dev</pre></code>

<p>и получим файл pack.js
Теперь мы можем заменить четыре подключаемых скрипта в нашем html файле на один:
</p>

<pre><code class="language-html">
&lt;!DOCTYPE html&gt;
&lt;html xml:lang="ru" lang="ru"&gt;
	&lt;head&gt;
		&lt;meta charset="UTF-8"&gt;
		&lt;title&gt;Empty web page&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
        &lt;!--script src="/js/jquery-3.3.1.slim.min.js"&gt;&lt;/script&gt;
        &lt;script src="/js/class_a.js"&gt;&lt;/script&gt;
        &lt;script src="/js/class_b.js"&gt;&lt;/script&gt;
        &lt;script src="/js/app.js"&gt;&lt;/script--&gt;
        &lt;script src="/js/pack.js"&gt;&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></code>

<p>Всё чудесно, вот только в консоли появилась ошибка &laquo;ReferenceError: B is not defined&raquo;
Чтобы избавиться от неё добавим импорты и экспорты:</p>


<p>Файл class_a.js</p>
<pre><code class="language-javascript">
class A {
	constructor() {
		this.init();
	}
	init() {
		console.log('I class A');
	}
}
export default A;
</pre></code>

<p>Файл class_b.js</p>
<pre><code class="language-javascript">
import A from './class_a';

class B extends A {
	init() {
		console.log('I class B');
	}
}

export default B;
</pre></code>

<p>Файл app.js</p>
<pre><code class="language-javascript">
import B from './class_b';

window.addEventListener('load', function() {
	new B(); 
});

</pre></code>
Выполним
<pre><code class="language-bash">npm run dev</pre></code>

<p>И убедимся, что всё заработало, то есть в консоли у нас снова видно «I class B» и никаких сообщений об ошибках.</p>
<p>В общем-то это всё, о чём планировалось рассказать в этой статье. </p>
<p>Добавлю, больше для самозакрепления, что вместо  </p>
<pre><code class="language-bash">npm run dev</pre></code>
<p>можно одинг раз запустить</p>
<pre><code class="language-bash">npm run watch</pre></code>

<p>Eсли бы наш класс A использовал jquery было бы небходимо написать в начале класса:</p>
<pre><code class="language-javascript">import $ from 'jquery'</pre></code>
<p>Путь при этом без <code>'./'</code> потому, что jquery у нас уже загружен во время </p>
<pre><code class="language-bash">npm run install</pre></code>
<p>(он указан в секции 'devDependencies' package.json).</p>
					</article>
				</div>
				<div class="col-12 col-lg-4  u-right-side">
					<ul class="list-group text-center">
						<li class="list-group-item">
							<div><img src="/i/fx.jpg" alt="Fastxampp"></div>
							<div> <!-- style="border-top-width: 0px;" -->
								<a href="//fastxampp.org" target="_blank">Утилита для удобного добавления сайтов на localhost</a>
							</div>
						</li> 
						<li class="list-group-item">
							<div><img src="/i/L.jpg"  alt="cordova online"></div>
							<div><a target="_blank" href="http://fastxampp.org/compile_android_online_apache_cordova/">Компиляция html5 приложений cordova для android онлайн</a><br>
								<p>
									<small>
									</small>
								</p>
							</div>
						</li>
						<li class="list-group-item">
							<div>
								<img src="/i/php2js.jpg" title="" alt="">
							</div>
							<div>
								<a href="http://php2js.ru/" target="_blank">Транслятор php кода в код javascript</a><br>
							</div>
						</li>
						<li class="list-group-item">
							<div><img src="/i/rc.jpg" alt="RedCafe"></div>
							<div><a href="http://redcafe.ru/">Программа для создания выкроек стильной одежды</a></div>
							<p>
								<small>Мой вклад - оффлайн-версия программы для экспорта выкроек в pdf и dxf</small></div>
							</p>
						</li>
					</ul>
				</div>
			</div>
		</div>
		
			<div class="footer bg-dark text-light">
				
					<div class="container">
						<div class="row">
							<div class="col">
								&copy; Андрей Ламзин
							</div>
						</div>
					</div>
				
			</div>
		
        <script src="/j/jquery-3.3.1.slim.min.js"></script>
        <script src="/j/bootstrap4.2.1.min.js"></script>
        <script src="/j/popper1.14.6.min.js"></script>
        <script src="/j/prism/0.js"></script>
        <script src="/j/app.js"></script> 
        <link rel="stylesheet" type="text/css" href="/s/bootstrap4_sticky_footer.css">
	</body>
</html>
